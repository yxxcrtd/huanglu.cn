<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="robots" content="all" />
        <meta name="keywords" content="黄麓、黄麓镇、书香黄麓、黄麓家园、黄麓网站" />
        <meta name="description" content="黄麓、黄麓镇、书香黄麓、黄麓家园、黄麓网站" />
        <title>书香黄麓</title>
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <link rel="stylesheet" type="text/css" href="css/jquery.fancybox.3.5.7.css" />
        <link rel="icon" type="image/x-icon" href="images/favicon.ico" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" /><!-- 页面自适应 -->
    </head>

    <body>
        <header id="header">
            <nav>
                <div id="logo"></div>
                <ul>
                    <li><a href="/">首页</a></li>
                    <li><a href="history">黄麓历史</a></li>
                    <li><a href="landscape">黄麓风景</a></li>
                    <li><a href="about" class="current">关于作者</a></li>
                </ul>
            </nav>
        </header>

        <article>
            <div id="articleDetail">
                <h2>Spring Boot 2.x 整合 Redis</h2>
                <div id="summary">
                    <p>
                        <span class="quote">“</span>
                        Spring Boot 2.x 整合 Redis
                    </p>
                </div>
                <div><p>1，添加依赖</p>
<p style="text-align: center;">
    <a href="images/article/article37.01.png" data-fancybox>
        <img src="images/article/article37.01.png" width="835" />
    </a>
</p>
<p>可以不需要 commons-pool2 依赖（参见官网说明：）</p>


<p>2，在 application.yml 添加 redis 配置</p>
<p style="text-align: center;">
    <a href="images/article/article37.02.png" data-fancybox>
        <img src="images/article/article37.02.png" width="835" />
    </a>
</p>


<p>3，增加 Redis 缓存配置类，添加 @Configuration  注解注入配置，让 Spring 自动扫描注入</p>
<p style="text-align: center;">
    <a href="images/article/article37.02.png" data-fancybox>
        <img src="images/article/article37.02.png" width="835" />
    </a>
</p>




package com.example.demo;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;

@Configuration //使用注解注入配置，必须要添加，这样application.properties中的配置才能在redis中生效，添加@Configuration之后，spring 会自动扫描注入
public class RedisConf {
    @Bean //声明一个Bean 这样其他地方可以通过@Autowired获取到生成的 RedisTemplate 对象
    public RedisTemplate rt(RedisConnectionFactory factory) {
        RedisTemplate template = new RedisTemplate();
        template.setConnectionFactory(factory);// 配置连接工厂　　　　　　//设置键值默认序列化方式　　　　 RedisSerializer stringSerializer = new StringRedisSerializer(); //RedisTemplate有自己的默认序列化的方式，不过使用默认方式，会在redis客户端查看的时候出现乱码，不便与使用，我们这里用falstjson库　　　　 template.setDefaultSerializer(stringSerializer);
        return template;
    }
}







1.springboot整合redis的两种连接方式

　　　　jedis：多线程下，非线程安全，所以使用连接池（不支持异步操作），适用springboot1.x

　　　　lettuce：多线程下，线程安全，基于Netty支持异步操作，适用springboot2.x0

　　2. spring boot2.x 默认使用lettuce连接，spring-boot-starter-data-redis集成了lettuce-core，引入spring-boot-starter-data-redis之后就不需要引入lettuce-core了，但是版本的lettuce-core需要commons-pool2。


Spring Boot2.x 后底层不再是Jedis，默认是Lettuce

Jedis在实现上是直连redis server，多线程环境下非线程安全（即多个线程对一个连接实例操作，是线程不安全的），除非使用连接池，为每个Jedis实例增加物理连接。Lettuce基于Netty的连接实例（StatefulRedisConnection），可以在多个线程间并发访问，且线程安全，满足多线程环境下的并发访问（即多个线程公用一个连接实例，线程安全），同时它是可伸缩的设计，一个连接实例不够的情况也可以按需增加连接实例。





<p>3，使用 RedisTemplate 或 StringRedisTemplate 操作 Redis </p>
<p style="text-align: center;">
    <a href="images/article/article37.03.png" data-fancybox>
        <img src="images/article/article37.03.png" width="835" />
    </a>
</p>

<br /></div>
                <h4>Posted: 2022-02-04 11:59:50</h4>
            </div>
            <div id="articleAside">
                <div id="category"></div>
            </div>
        </article>

        <footer id="footer"></footer>

        <script src="js/jquery-3.6.0.js"></script>
        <script src="js/public.js"></script>
        <script src="js/jquery.fancybox.3.5.7.js"></script>
    </body>
</html>